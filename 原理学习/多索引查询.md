Elasticsearch 可以不用这样，它提供了两个维度的拆分方式，第一维度采用多个索引命名拆分，第二维度采用索引多分片，对于查询来说，可以灵活匹配索引，一次指定一个索引，也可以一次指定多个索引。

https://zhuanlan.zhihu.com/p/145021757

实时数据与历史数据存储和查询问题
跨索引查询应用方式

直接型
明确指定多个索引名称，这种方式一般应用在非常精确的查询场景下，便于查询索引范围，性能平衡考虑，若索引不存在会出现错误，如下：index_01,index_02

GET /index_01,index_02/\_search
{
"query" : {
"match": {
"test": "data"
}
}
}

模糊型
不限定死索引名称，这种方式一般采用通配符，无需判断该索引是否存在，支持前匹配、后匹配，前后匹配，如下：index\_\* 匹配前缀一样的所有索引

GET /index\_\*/\_search
{
"query" : {
"match": {
"test": "data"
}
}

计算型
索引名称通过计算表达式指定，类似正则表达式，也可以同时指定多个索引，如下：logstash-{now/d}表示当前日期

# 索引名称如：index-2024.03.22

# GET /<index-{now/d}>/\_search

GET /%3Cindex-%7Bnow%2Fd%7D%3E/\_search{
"query" : {
"match": {
"test": "data"
}
}
}

查询过程简单说来就是分发与合并：

查询分发，客户端发送请求到协调节点，协调节点分发查询请求到索引分片节点；
数据合并，索引分片节点将数据发送到协调节点，协调节点合并返回客户端。
所以说，Elasticsearch 提供跨索引查询的能力，实际上与原来单索引查询时一样，本质上是跨多个分片查询，然后合并。

索引与分片等价关系
索引与分片等价的关系，1 个索引 20 分片与 4 个索引每个索引 5 个分片理论上是等价的，鉴于索引分片的容量限制与性能平衡，在面对需要跨索引业务场景时，索引的数量与分片的数量尽量的少，既要保障索引热点数据的实时处理能力，也要平衡历史数据的查询性能。

协调节点分离
鉴于 Elastic 查询过程，在跨多个索引查询时，协调节点承担了所有分片查询返回的数据合并，需要消耗很大资源，在应对高并发场景，建议部署独立的协调节点，将集群的数据节点与协调节点分离，以达到最佳的性能平衡。

路由机制
Elasticsearch 写入数据分布默认是基于索引主键 \_id 的 Hash 值，此机制在数据分布上很均衡，但也没有什么规律，对于跨索引查询场景，若自定义指定路由键，可以在搜索时避开不需要的索引分片，有效减少分片查询的分片数量，达到更高的性能。

若存在相同字段，可以按照之前的方式查询，只是在 index 处放两个索引名称
若筛选字段都不一致，无法提取出公共字段，可以参考以下方法

POST /_search
{
    "query": {
        "bool": {
            "should": [
                {
                    "bool": {
                        "must": [
                            {
                                "term": {
                                    "_index": "user"
                                }
                            },
                            {
                                "term": {
                                    "username": "Opster"
                                }
                            }
                        ]
                    }
                },
                {
                    "bool": {
                        "must": [
                            {
                                "term": {
                                    "_index": "tweet"
                                }
                            },
                            {
                                "term": {
                                    "data": "some text"
                                }
                            }
                        ]
                    }
                }
            ]
        }
    }
}
https://blog.csdn.net/qq_37147750/article/details/111319151